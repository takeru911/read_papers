# Natural Evolution Strategies

## Authors
 * Daan Wierstra
 * Tom Schaul
 * Jan Peters
 * Juergen Schmidhuber


## Abstract

この論文ではNatural Evolution Strategies(NES)についての論文。
NESはブラックボックスな関数の最適化のための新しい手法で、この最適化は未知の目的関数を、アクセス可能（ぼんやりわかるが）な情報だけで関数の評価を行う。
NESでは目的関数の形状の探索を自己適応型突然変異行列を用いた多変量正規分布により良い評価を持つ探索空間に相関する突然変異を行いつつ行う(小難しい?)。
NESはthis property(なにをさすのか、アルゴリズムのパラメータ？)をCMA-ESと共有している。CMA-ESは高精度な最適化アルゴリズムとしてよく知られている。
NESは簡単でありながら、汎用性もありつつ原則に基づいた（理論的？）アルゴリズムである.
突然変異行列の自己適応はモンテカルロ法による事前勾配の推定の派生を用いる。
下記のように自然勾配は普通の勾配の代わりで、効率的に勾配を更新しつつ、貪欲な更新による早期収束を防げることで、
局所解に陥ることを減らす。
この論文では、CMA-ESと単峰性問題や多峰性問題で比較を行い、良さげな結果がでることを示す。


## Introduction

実数値のブラックボックス関数の最適化は機械学習の研究分野においてメジャーなトピックの一つである。
ブラックボックス最適化は未知でいくつかの目的関数（評価関数とも呼ばれる）を連続的なパラメータを最適化することに関わる。
正確な目的関数の構造は未知もしくは特定されていないとか停止しているが、関数の測定法は存在する。
これは現実世界の問題で繰り返しおきており、問題の正確な構造はエンジニアには利用不可能だったり、モデル化だったり、シミュレーションは高価過ぎる。
数多くの現実世界の問題は、ブラックボックス最適化問題として取り扱うことが可能である。
一般的な問題設定の重要性および一般性（よくあるよー的な）を説明するため、ノズル形状設計問題、Aiboロボットの方向、非マルコフ nuerocontrolとかがある。

探索空間を全て探索するのは現実的ではないので、目的関数の正確なモデル化は想定しない、さらに事前に定義された制約条件の中で良い解を見つけようとしたい。
これは必然的にちゃんとしたintelligent heuristic approach（meta heuristic?ちょっと違う気もする）を使うこととなる。
これは大雑把に感じるかもしれないが、実際には収束スピードや、解のクオリティ目的関数の形状で局所解に陥らないようにするとかで問題に適したトレードオフの問題が発生する。
この種類のアルゴリズムはいろいろあり、焼きなまし法や同時摂動確率近似法、ヒルクライム法、粒子群最適化、進化的アルゴリズムの手法群。

進化戦略はダーウィンの進化論にinspireされなづけられ、一般的には集団を世代として連続的にもつようなものである。
各世代では、親のパラメータを変動（遺伝子の突然変異）させて生成された集団である（ESは一般的に無性生殖であり、新しい個体は遺伝的アルゴリズムで言うところの交叉やそれに似た手法での交代生成は行わないことに注意）
いくつかのサンプルを適応度を基準に選択されるが悪い適応度を持つ個体は捨てられる。良い適応度を持つ個体は次の世代の親個体として用いられ、目的関数が世代を経るごとに高くなっていく。
これはESにおける基本的なフレームワークで、シンプルでヒューリスティックな性質を持っており、これは非常に強力であり、ロバストな性質を餅、様々な派生アルゴリズムが作られている。

進化戦略において、突然変異は一般的に問題のパラメータに基づいた突然変異サイズ（突然変異の確率？、個体数？、あ本質的に同じか）による正規分布である。
進化戦略の主要な研究トピックでは突然変異のサイズを自動で調整する分野がある。
明らかに,とても大きな突然変異サイズの選択は、突然変異が機能しなくなるし、探索が十分に収束しきらないだろう。
小さすぎる突然変異サイズの選択は、収束せずに局所的な解に陥ってしまう。
一般的に突然変異サイズは小さい値の範囲（evolution windowとしてしられている）で選択すべきである。
したがって進化戦略は、最適化の過程にもとづき、進化中（最適化中）に突然変異サイズは調整したほうがよい。
しばしばこれは、問題のパラメータと突然変異サイズは最適化中堂寺に行われる。

CMA-ESはより洗練された手法である。CMA-ESは分散共分散突然変異ベクトルΣを多変量正規分布を用いて更新していく。
これにより相関突然変異（？）の生成が可能となり、進化を大幅に高速化させる。
この突然変異行列の自己適応は、似た突然変異を起こりやすくしたり、過去の進化履歴で良い突然変異という情報を統合して行う。
CMA-ESはベンチマークで良い性能を出している。とはいえCMA-ESにも問題はあり、其の一つにアドホックな性質、比較的複雑もしくは不自然な数学的な正当性、そして大雑把さである。別の問題に局所的最適化に結構はまっちゃうって問題もある。

この論文のゴールは実数値のブラックボックス関数最適化を、第一原理（？）から派生したしっかりとした数学的なメカニズムにより発展させる。
同時に、我々は任意の精度、CMA-ESのような先行手法と比較して局所解に陥りにくいような最適化ができる手法の開発を行う。
私達が提示するのはNatural Evolution Strategiesというすばらしい手法で、CMA-ESの相関突然変異を引き継ぎ、局所解に陥ってしまうような部分は強化する。

私達の手法であるNES（実際には(1,λ)-ESのように見ることが可能で、1世代で1つの候補とλの子をもつ）は、突然変異行列と親個体の適応をnatural gradientに基づいたstepの更新によりそれぞれ行う。
毎世代で、よりよさそうな適応度への勾配がモンテカルロ法により推定される。この勾配は、親子体のパラメータ、突然変異行列の更新にそれぞれ使用される。natural gradientを vanilla gradientをしようし、局所的な最適解の早期収束を防ぐ。

